# NOI 省队名额分配模拟器

本项目是一个用于模拟和理解NOI（全国青少年信息学奥林匹克竞赛）省队名额分配机制的工具。它根据CCF官方发布的《NOI名额分配方案》进行设计，旨在帮助信息学竞赛爱好者和教练更好地理解名额的计算和分配过程。

> **重要声明**: 本项目为个人研究与模拟性质，与CCF（中国计算机学会）无任何官方关联。本项目发布的所有内容，包括但不限于计算结果、数据分析和模拟预测，均不代表CCF官方立场。所有官方信息请以CCF官方渠道发布为准。

## 名额分配方案简介 (基于NOI2025方案)

根据CCF于2025年11月发布的[《NOI2026名额分配测算方案》](https://www.noi.cn/xw/2025-10-11/849353.shtml)，NOI省队名额由A、B两类构成。

- **A类名额**: 每省5个，其中至少包含1名女选手。
- **B类名额**: 奖励性名额，由三部分（B1, B2, B3）加和计算得出，每年总数 `S` 由CCF确定。
    - **B1 (普及项, 占比50%)**: 根据各省NOIP参赛人数在全国总人数中的比例进行分配。
    - **B2 (综合项, 占比30%)**: 根据各省NOIP成绩分段（`K1`段）后的平均分进行全国排名分配。
    - **B3 (拔尖项, 占比20%)**: 根据各省NOIP排名前`K2`的拔尖成绩进行全国排名分配。
- **重要约束**:
    - B类名额计算结果需四舍五入。
    - 各省B类名额总数受该省NOIP非零分选手总数的 `P`% (默认为5%) 的比例限制，且上限不超过12个。
    - `S`, `K1`, `K2`, `P` 等核心参数由CCF在每年执行时最终确定并公布。

本项目严格依据上述规则进行模拟计算。

## 项目特点

- **自动化模拟**: 自动处理各省成绩，执行完整的B1、B2、B3名额计算逻辑。
- **参数化配置**: 核心参数（如 `S`, `K1`, `K2`等）均可在脚本中配置，方便对不同参数下的分配结果进行模拟和预测。
- **数据驱动**: 计算完全基于真实的NOIP参赛人数和成绩数据。
- **结果清晰**: 输出详细的各省名额分配表，并保存为CSV文件，便于存档和分析。

## 项目结构

```
.
├── results/                     # 存放各省NOIP成绩CSV文件的目录。注意：本目录下的CSV文件（如`NOIP_2025_XX_批量测试.csv`）在项目中是随机生成的模拟数据，不具有实际参考价值。
│   └── NOIP_2025_XX_批量测试.csv
├── .venv/                       # Python虚拟环境
├── calculate_noi_quotas.py      # 核心计算脚本
├── scraper.py                   # [工具] 用于从网站上爬取各省成绩的爬虫
├── generate_csv_from_text.py    # [工具] 用于从原始文本生成参赛人数CSV
├── noip2025_participants.csv    # [输入] 各省参赛人数数据 (由generate_csv脚本生成)
├── noi2025_calculated_quotas.csv # [输出] 最终计算出的省队名额分配结果
├── pyproject.toml               # 项目依赖定义 (使用uv管理)
├── requirements.txt             # 完整的依赖锁文件 (由uv生成)
└── README.md                    # 本文档
```

## 使用方法

### 1. 环境设置

本项目使用 [uv](https://github.com/astral-sh/uv) 进行快速的环境和依赖管理。

```bash
# 1. 创建虚拟环境
uv venv

# 2. 激活虚拟环境
# macOS / Linux
source .venv/bin/activate
# Windows
.venv\Scripts\activate

# 3. 安装所有依赖
uv pip sync requirements.txt
```

### 2. 数据准备

计算需要两类输入数据：

- **各省参赛人数**:
  运行 `generate_csv_from_text.py` 脚本，它会根据内置的原始文本数据，自动生成`noip2025_participants.csv`文件。该文件的省份列将使用标准的省份代码（如 'GD', 'SC'）。
  ```bash
  python generate_csv_from_text.py
  ```

- **各省NOIP成绩**:
  将所有省份的NOIP成绩CSV文件放入 `results/` 文件夹中。
  - **文件来源**: 您可以使用 `scraper.py` 爬虫脚本来下载这些文件。使用前请根据脚本内的提示配置好请求头（特别是Cookie，如果需要登录）。
  - **数据格式要求**: 成绩CSV文件必须包含`用户`和`总分数`两列。脚本会自动从`用户`列（如 'AH-0002'）中提取前两个字母作为省份代码。

### 3. 参数配置 (重要)

打开 `calculate_noi_quotas.py` 脚本，在文件顶部的配置区域，您可以根据需要调整核心计算参数。

**请注意**: 这些参数为模拟所用的**假设值**。每年的官方准确数值（如B类总名额 `S` 等）由CCF发布，请以官方通知为准。

```python
# ==============================================================================
# 核心假设与可配置参数 (根据 NOI2025 官方方案)
# ==============================================================================
S_TOTAL_B_QUOTAS = 150  # B类总名额 S (假设值)
K1_SEGMENTS = 5         # 综合项分数段数 K1 (假设值)
K2_TOP_SCORES = 5       # 拔尖项取前 K2 名 (假设值)
# ...
```

### 4. 执行计算

确保您的虚拟环境已激活，并且输入数据已准备就绪。

```bash
python calculate_noi_quotas.py
```

### 5. 查看结果

脚本执行后，会：
1.  在终端（控制台）中打印出详细的模拟结果表格。
2.  将完整的模拟结果保存到 `noi2025_calculated_quotas.csv` 文件中，供您查阅和使用。